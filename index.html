<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Recordatorio rese√±a Atr√°palo</title>
  <style>
    body {  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  text-align: center;   padding: 40px 20px;   background: #ffffff;   color: #000000; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 28px 18px 40px; }
    .card { background: #ffffff;   border: 1px solid #e5e5e5; border-radius:16px; padding:18px; box-shadow: 0 10px 30px rgba(0,0,0,.35); }
    h1 { font-size: 20px; margin: 0 0 8px; }
    p { line-height: 1.35; margin: 10px 0; color:#000000; }
    .row { display:flex; gap:12px; flex-wrap:wrap; margin-top: 14px; }
    a.btn, button.btn {
      appearance:none; border:1px solid #3a3a44; background:#1f1f25; color:#fff;
      padding:12px 14px; border-radius:12px; text-decoration:none; font-weight:600; cursor:pointer;
      flex: 1 1 240px; text-align:center;
    }
    a.btn:hover, button.btn:hover { background:#26262e; }
    .small { font-size: 12px; color:#000000; margin-top:10px; }
    code { background: transparent;  color: #000;  padding: 0;  border-radius: 0;  font-size: 0.95em;  font-family: inherit;}
    .muted { color:#000000; }
    .hr { height:1px; background:#e5e5e5; margin: 14px 0; }
  </style>
</head>
<body>
<div style="
  max-width: 720px;
  margin: 0 auto 40px;
  text-align: center;
">
  <h1 style="
    margin-bottom: 10px;
    font-size: 2.4em;
    line-height: 1.15;
  ">
    Gracias por venir ‚ù§Ô∏è
  </h1>
  <p style="
    margin-top: 0;
    font-size: 1.4em;
    color: #000;
  ">
    ‚ú® Eres un √°ngel, nunca dejes de volar ‚ú®
  </p>
</div>
  <div class="wrap">
    <div class="card">
      <h2>üìå Recordatorio: deja tu rese√±a en Atr√°palo</h2>
      <p>Te pongo un recordatorio para <b>dentro de 2 d√≠as</b> (cuando suele llegar el email) para que revises tu correo y dejes la rese√±a. ‚ù§Ô∏è</p>

      <div class="hr"></div>

      <p class="muted"><b>¬øCu√°ndo te avisar√°?</b><br>
        <span id="whenText">Calculando‚Ä¶</span>
      </p>

      <div class="row">
        <a id="googleLink" class="btn" href="#" rel="nofollow">A√±adir a Google Calendar</a>
        <button id="appleBtn" class="btn" type="button">A√±adir a iPhone / Apple Calendar</button>
      </div>

      <p class="small">Si no usas calendario, igualmente: en 2 d√≠as busca en Gmail ‚ÄúAtr√°palo‚Äù (mira tambi√©n <i>Promociones</i> o <i>Spam</i>).</p>
      <p class="small">Tip: si el bot√≥n de Apple no abre directamente, te descargar√° un archivo <code>.ics</code>. √Åbrelo y se a√±ade al Calendario.</p>
    </div>
  </div>

<script>
(function () {
  // === PERSONALIZA AQU√ç ===
  const EVENT_TITLE = "üì© Correo de Atr√°palo ‚Äì rese√±a del show de Pablo Lar√°n";
  const EVENT_LOCATION = "";
  const EVENT_DETAILS =
`Revisa tu correo de Atr√°palo y deja la rese√±a del show.
‚Ä¢ Busca "Atr√°palo" en Gmail
‚Ä¢ Mira tambi√©n Promociones/Spam
¬°Gracias de verdad! ‚ù§Ô∏è`;

  // Hora del recordatorio: 19:00 local (aj√∫stalo si quieres)
  const REMINDER_HOUR = 12;
  const REMINDER_MINUTE = 0;

  // D√≠as en el futuro
  const DAYS_AHEAD = 2;

  // Duraci√≥n del evento (min)
  const DURATION_MINUTES = 10;

  // === L√ìGICA ===
  const now = new Date();
  const start = new Date(now);
  start.setDate(start.getDate() + DAYS_AHEAD);
  start.setHours(REMINDER_HOUR, REMINDER_MINUTE, 0, 0);

  const end = new Date(start);
  end.setMinutes(end.getMinutes() + DURATION_MINUTES);

  // Mostrar texto humano
  const fmt = new Intl.DateTimeFormat('es-ES', { weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit' });
  document.getElementById('whenText').textContent = fmt.format(start);

  // Google Calendar template URL
  // dates en formato YYYYMMDDTHHMMSSZ (UTC). Convertimos a UTC:
  function toUTCCompact(d) {
    const y = d.getUTCFullYear();
    const m = String(d.getUTCMonth()+1).padStart(2,'0');
    const day = String(d.getUTCDate()).padStart(2,'0');
    const hh = String(d.getUTCHours()).padStart(2,'0');
    const mm = String(d.getUTCMinutes()).padStart(2,'0');
    const ss = String(d.getUTCSeconds()).padStart(2,'0');
    return `${y}${m}${day}T${hh}${mm}${ss}Z`;
  }

  const gUrl = new URL("https://calendar.google.com/calendar/render");
  gUrl.searchParams.set("action", "TEMPLATE");
  gUrl.searchParams.set("text", EVENT_TITLE);
  gUrl.searchParams.set("dates", `${toUTCCompact(start)}/${toUTCCompact(end)}`);
  if (EVENT_DETAILS) gUrl.searchParams.set("details", EVENT_DETAILS);
  if (EVENT_LOCATION) gUrl.searchParams.set("location", EVENT_LOCATION);

  document.getElementById("googleLink").href = gUrl.toString();

  // ICS generator for Apple Calendar
  function icsEscape(s) {
    return String(s)
      .replace(/\\/g, "\\\\")
      .replace(/\n/g, "\\n")
      .replace(/,/g, "\\,")
      .replace(/;/g, "\\;");
  }

  // ICS uses UTC timestamps
  function toICSUTC(d) {
    const y = d.getUTCFullYear();
    const m = String(d.getUTCMonth()+1).padStart(2,'0');
    const day = String(d.getUTCDate()).padStart(2,'0');
    const hh = String(d.getUTCHours()).padStart(2,'0');
    const mm = String(d.getUTCMinutes()).padStart(2,'0');
    const ss = String(d.getUTCSeconds()).padStart(2,'0');
    return `${y}${m}${day}T${hh}${mm}${ss}Z`;
  }

  const uid = `atrapalo-review-${Date.now()}@qr`;
  const dtstamp = toICSUTC(new Date());

  const ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//QR Rese√±a Atrapalo//ES
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${uid}
DTSTAMP:${dtstamp}
DTSTART:${toICSUTC(start)}
DTEND:${toICSUTC(end)}
SUMMARY:${icsEscape(EVENT_TITLE)}
DESCRIPTION:${icsEscape(EVENT_DETAILS)}
LOCATION:${icsEscape(EVENT_LOCATION)}
END:VEVENT
END:VCALENDAR`;

  document.getElementById("appleBtn").addEventListener("click", () => {
    const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "recordatorio-atrapalo.ics";
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(() => URL.revokeObjectURL(url), 1000);
  });
})();
</script>
</body>
</html>





